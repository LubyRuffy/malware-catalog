/* 
  These are rules to detect QBOT sources, and binaries for little/big endian arches.
  Based on the PRNG commonly used by QBOTS.
*/

rule phiSRC : QBOT { 
meta:
  Author = "u"
  Description = "Checks for PHI-based PRNG within a source file. QBOT + Some Mirai"
strings:
   $phi0 = "0x9e3779b9"
condition:
   $phi0
}
rule phiLE : QBOT {
meta:
  Author = "u"
  Description = "Checks for PHI-based PRNG - Little Endian"
strings:
  $phi0 = {b9 79 37 9e}
condition:
  $phi0
}
rule phiBE : QBOT {
meta:
  Author = "u"
  Description = "Checks for PHI-based PRNG - Big Endian"
strings:
  $phi0 = {9e 37 79 b9}
condition:
  $phi0
}
